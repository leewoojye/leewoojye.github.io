---
layout: post
title:  "Maximum-Mean-Discrepancy(MMD) clearly explained!"
date:   2026-01-26 15:24:30 +0900
comments: true
categories: dev
---

maximum mean discrepancy : 두 확률 분포 차이를 정량화하기 위한 지표 중 하나로, 재생 커널 힐베르트 공간(Reproducing Kernel Hilbert Space)에서 분포의 평균 임베딩 차이를 비교
kernel function : 입력 공간의 데이터 포인트를 고차원 공간으로의 점으로 변환하는 함수
- 가우스 커널
- 다항식 커널

MMD clearly explained
![alt text](image-7.png)
![alt text](image-8.png)
![alt text](image-10.png)
데이터 분석시 낮은 차원에서는 선형분리할 수 없는 복잡한 분포를 마주할 때가 있습니다. 이를 해결하기 위해 낮은 차원의 데이터 포인트를 고차원 공간의 점으로 매핑하게 되는데,
- 차원 증가에 따른 계산 비용 증가
- 어떤 매핑 함수 $\phi$를 사용할지 결정하는데 어려움

크게 두 문제가 잇따르게 됩니다. 근데 우리는 두 데이터 포인트 x,y에 대한 매핑 $\phi$(x),$\phi$(y) 간 내적에만 관심이 있는 경우가 많고, 두 매핑 결과에 대한 내적을 '커널 함수'로 정의할 수 있습니다.

여기서 조금 더 나아가자면 수학적으로 커널 함수가 제 역할을 하려면 Mercer's Theorem을 만족해야 합니다.
- 대칭성 : $k(x, y) = k(y, x)$
- 양의 준정부호 : 커널 행렬(Gram Matrix)을 만들었을 때 모든 고윳값이 0 이상이어야 합니다.

이 조건이 충족되어야만 우리가 계산한 값이 "어떤 고차원 공간에서의 내적"이라는 통계적 의미를 가질 수 있습니다.

커널 함수에는 여러 종류가 있으며 함수 종류에 따라 데이터 분포에서 반영할 모먼트, 데이터의 특징들이 달라지므로 커널 함수 선정은 중요한 문제입니다.
![alt text](image-9.png)
=> 커널함수 종류 <br>
$$k(x, y) = \exp \left( -\frac{\|x-y\|^2}{2\sigma^2} \right)$$
$$e^x = 1 + x + \frac{1}{2!}x^2 + \frac{1}{3!}x^3 + \dots$$
가우시안 커널 수식에 포함된 exp()는 아래 식과 같이 지수 함수의 테일러 급수 형태를 띄게 됩니다. 이때 저차원 데이터 포인트 x에 대해 x에 대한 1차식부터 무한차수까지 다루므로 모든 모멘트를 반영하는 커널 함수가 된 셈입니다. (1차식은 평균이라는 모멘트, 2차식은 분산이라는 모멘트 등등) 참고로 꼭 가우시안 분포가 아니더라도 exp()가 포함된 커널 함수라면 자동적으로 모든 모멘트를 반영한 커널 함수가 됩니다.